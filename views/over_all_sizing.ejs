
    <!-- Tab Navigation -->
    <div class="mx-auto w-[95%] bg-gray-700 text-white">
        <div class="flex justify-around py-4 cursor-pointer">
            <div id="final_sizing_tab" class="tab-title text-center text-lg font-bold py-2 px-5 bg-blue-600 rounded shadow-xl">
                Detail Sizing
            </div>
            <div id="service_level_sizing_tab" class="tab-title text-center text-lg font-bold py-2 px-5 rounded shadow-xl">
                Service Level Sizing
            </div>
        </div>
    </div>

    <!-- Final Sizing Table -->
    <div id="final_sizing_table" class="tab-content my-4">
        <section>
            <div class="mx-auto w-[95%] bg-gray-700 text-white">
                <div class="flex justify-around py-4 cursor-pointer">
                    <div id="k8s_tab" class="tab-title text-center text-lg font-bold py-2 px-5 bg-blue-600 rounded shadow-xl" onclick="activateTab('k8s_tab', 'k8s_table', 'vms_table')">
                        Sizing on a Managed K8S Environment
                    </div>
                    <div id="vms_tab" class="tab-title text-center text-lg font-bold py-2 px-5 rounded shadow-xl" onclick="activateTab('vms_tab', 'vms_table', 'k8s_table')">
                        Sizing on VMs
                    </div>
                </div>
            </div>

            <!-- First Table -->
            <div id="k8s_table" class="tab-content my-4 overflow-x-auto">
                <table class="mx-auto mb-8 w-[95%]">
                    <thead>
                        <tr>
                            <% page_info.table_data.final_sizing_header_1.forEach(function(header) { %>
                                <th class="bg-gray-300 shadow-2xl p-2"><%= header %></th>
                            <% }); %>
                        </tr>
                    </thead>
                    <tbody>
                        <% page_info.table_data.final_sizing_rows_1.forEach(function(row) { %>
                            <tr>
                                <% row.forEach(function(item, index) { %>
                                    <% if (row[0] === 'TOTAL' && index === row.length - 1) { %>
                                        <td class="p-2 border font-bold" colspan="<%= row.length %>"><%= item %></td>
                                    <% } else { %>
                                        <td class="p-2 border <%= row[0] === 'TOTAL' ? 'font-bold' : '' %>"><%= item %></td>
                                    <% } %>
                                <% }); %>
                            </tr>
                        <% }); %>
                    </tbody>
                </table>
            </div>

            <!-- Second Table -->
            <div id="vms_table" class="tab-content my-4 hidden overflow-x-auto">
                <table class="mx-auto w-[95%]">
                    <thead>
                        <tr>
                            <% page_info.table_data.final_sizing_header_2.forEach(function(header) { %>
                                <th class="bg-gray-300 shadow-2xl p-2"><%= header %></th>
                            <% }); %>
                        </tr>
                    </thead>
                    <tbody>
                        <% page_info.table_data.final_sizing_rows_2.forEach(function(row) { %>
                            <tr>
                                <% row.forEach(function(item, index) { %>
                                    <% if (row[0] === 'TOTAL' && index === row.length - 1) { %>
                                        <td class="p-2 border font-bold" colspan="<%= row.length %>"><%= item %></td>
                                    <% } else { %>
                                        <td class="p-2 border <%= row[0] === 'TOTAL' ? 'font-bold' : '' %>"><%= item %></td>
                                    <% } %>
                                <% }); %>
                            </tr>
                        <% }); %>     </tbody>
                </table>
            </div>     <button class="bg-blue-600 text-white px-5 py-2 rounded mx-[3%]" onclick="exportToExcel()">Export to Excel</button>
        </section>
    </div>

    <!-- Service Level Sizing -->
    <div id="service_level_sizing_table" class="tab-content my-4 hidden overflow-x-auto">
        <table class="mx-auto w-[95%]">
            <thead>
                <tr>
                    <% page_info.table_data.service_level_headers.forEach(function(header) { %>
                        <th class="bg-gray-300 shadow-2xl p-2"><%= header %></th>
                    <% }); %>
                </tr>
            </thead>
            <tbody>
                <% page_info.table_data.service_level_rows.forEach(function(row) { %>
                    <tr>
                        <% row.forEach(function(item) { %>
                            <td class="p-2 border"><%= item %></td>
                        <% }); %>
                    </tr>
                <% }); %>
            </tbody>
        </table>
    </div>

    <script>
        // Function to activate tabs within Final Sizing (K8S/VMs)
        function activateTab(activeTabId, contentToShowId, contentToHideId) {
            // Get elements
            const activeTab = document.getElementById(activeTabId);
            const contentToShow = document.getElementById(contentToShowId);
            const contentToHide = document.getElementById(contentToHideId);

            // Highlight the active tab
            document.querySelectorAll('.tab-title').forEach(tab => tab.classList.remove('bg-blue-600'));
            activeTab.classList.add('bg-blue-600');

            // Toggle visibility of content
            contentToShow.classList.remove('hidden');
            contentToHide.classList.add('hidden');
        }

        // Function to activate main tabs
        function main_activateTab(tab, contentToShow, contentToHide) {
            document.querySelectorAll('.tab-title').forEach(t => t.classList.remove('bg-blue-600'));
            tab.classList.add('bg-blue-600');

            contentToShow.classList.remove('hidden');
            contentToHide.classList.add('hidden');
        }

        // Add event listeners for main tabs
        document.getElementById('final_sizing_tab').addEventListener('click', () => {
            main_activateTab(
                document.getElementById('final_sizing_tab'),
                document.getElementById('final_sizing_table'),
                document.getElementById('service_level_sizing_table')
            );
        });

        document.getElementById('service_level_sizing_tab').addEventListener('click', () => {
            main_activateTab(
                document.getElementById('service_level_sizing_tab'),
                document.getElementById('service_level_sizing_table'),
                document.getElementById('final_sizing_table')
            );
        });

        // Export to Excel
        function exportToExcel() {
            const workbook = XLSX.utils.book_new();

            // K8S Table
            const k8sTable = document.getElementById('k8s_table');
            const k8sSheet = XLSX.utils.table_to_sheet(k8sTable);
            XLSX.utils.book_append_sheet(workbook, k8sSheet, 'Sizing on K8S');

            // VMs Table
            const vmsTable = document.getElementById('vms_table');
            const vmsSheet = XLSX.utils.table_to_sheet(vmsTable);
            XLSX.utils.book_append_sheet(workbook, vmsSheet, 'Sizing on VMs');

            // User Inputs 
            const userInputs = document.getElementById('user_inputs');
            const userInputsSheet = XLSX.utils.table_to_sheet(userInputs);
            XLSX.utils.book_append_sheet(workbook, userInputsSheet, 'User Inputs');

            // Service Level Sizing 
            const serviceLevelSizingTable = document.getElementById('service_level_sizing_table');
            const serviceLevelSizingSheet = XLSX.utils.table_to_sheet(serviceLevelSizingTable);
            XLSX.utils.book_append_sheet(workbook, serviceLevelSizingSheet, 'Service Level Sizing');

            XLSX.writeFile(workbook, 'sizing_data.xlsx');
        }
    </script>
